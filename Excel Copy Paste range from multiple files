
'open all the files to concatenate in certain range
'open "Book1.xls"

Sub Excel_Concatenate_multiple_files()
'


'Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim m As Integer
Dim n As Integer
Dim nrow As Integer
Dim plotName As String
Dim sHape As sHape
Dim BOOKCnt As Integer
Dim HOMEWKBK As String
Dim RNG As String
Dim RNG1 As String
Dim RNG2 As String
Dim sheetCnt As Integer
Dim str1 As String
Dim str2 As String
Dim e As Integer


BOOKCnt = Application.Workbooks.Count

Application.DisplayAlerts = True
k = 0
nrow = 16


For i = 1 To BOOKCnt
    Workbooks(i).Activate
    wkb_name = Workbooks(i).Name
    If Not wkb_name = "Book1.xls" Then
    
         Sheets("data").Activate
         If k = 0 Then
            Range("A95:U111").Select
         Else
            Range("A96:U111").Select
         End If
         Selection.Copy
         k = k + 1
         
         Workbooks("Book1").Activate
         n = ActiveSheet.UsedRange.Rows.Count
            
         Cells(n + 1, 1).Select
         ActiveSheet.Paste
         
        str1 = Str(n + 1)
        str2 = Str(n + 16)
        
        If k = 1 Then
            e = 17
        Else
            e = 16
        End If
        
        
        
        
        For j = n + 1 To n + e
            Cells(j, 22).Value = wkb_name
        
        Next j


         
    End If
    
Cells(2, 22) = "File Name"

Next i
'
End Sub
